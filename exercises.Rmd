---
title: "Ejercicios intervalos de confianza y pruebas de hip칩tesis"
author: "Nicol치s Molano Gonzalez"
date: "January 1, 2015"
output: 
  html_document:
    fig_caption: true
---
```{r echo=F, message = FALSE, warning =F}
library(datasets)
library(tidyverse)
library(kableExtra)
library(knitr)
```
# Formulas de intervalos de confianza
## Intervalo de confianza para el valor esperado
La formula del intervalo de confianza para el valor esperado tiene la siguiente formula:

$$\Bigg(\bar{X}-t_{n-1,1-\frac{\alpha}{2}}\times\frac{S}{\sqrt{n}},\bar{X}-t_{n-1,\frac{\alpha}{2}}\times\frac{S}{\sqrt{n}}\Bigg)$$

Donde:

* $\bar{X}$ es el promedio calculado con la muestra
* $S$ Es la desviacion estandar calculada con la muestra
* $n$ es el tama침o de la muestra y $\sqrt{n}$ su raiz cuadrada
* $t_{n-1,\frac{\alpha}{2}}$ es el cuantil $\frac{\alpha}{2}$ de la distribucion $T$ con $n-1$ grados de libertad
* $t_{n-1,1-\frac{\alpha}{2}}$ es el cuantil $1-\frac{\alpha}{2}$ de la distribucion $T$ con $n-1$ grados de libertad

Por ejemplo en la figura \ref{fig:tdensity} se muestran los cuantiles $t_{70,0.025}=-1.994$ y $t_{70,0.975}=1.994$ para una distribucion $T$ con $70$ grados de libertad.

```{r tdensity, echo=F, fig.width=6, fig.height=4, fig.cap="\\label{fig:tdensity} Desnidad de la distribucion T"}
ggplot(data = data.frame(x = c(-5, 5)), aes(x)) +
  stat_function(fun = dt, args = list(df = 70))+ylab("f(t)")+
  geom_segment(aes(x=qt(.975,70),xend=qt(.975,70),y=0,yend=dt(qt(.975,70),70)))+
  geom_segment(aes(x=qt(.025,70),xend=qt(.025,70),y=0,yend=dt(qt(.025,70),70)))+
  scale_x_continuous("t", round(c(-5,qt(1-.975,70),0,qt(.975,70),5),3), limits=c(-5,5))+
  annotate("segment", x = c(-2.2,2.2), xend = c(-3.8,3.8), y = c(0.02,0.02), yend = c(.16,.16), colour = "red", size=1, alpha=0.6, arrow=arrow())+
  annotate("text", x = c(-3.8,3.8), y = c(0.17,0.17), label = c("P(T < -1.994)=0.025", "P(T > -1.994)=0.025") , size=4 , fontface="bold")+
  theme_bw()
```

Es importante entender que el parametro grados de libertad cambia la forma de la curva, como se puede apreciar en la figura
 \ref{fig:gd}

```{r gd, echo=F, fig.width=6, fig.height=4, fig.cap="\\label{fig:gd} Grados de libertad en la distribucion T"}
ggplot(data = data.frame(x = c(-3, 3)), aes(x)) +
  stat_function(fun = dt, args = list(df = 70),color="blue")+ylab("f(t)")+xlab("t")+
  stat_function(fun = dt, args = list(df = 35),color="green")+
  stat_function(fun = dt, args = list(df = 10),color="orange")+
  stat_function(fun = dt, args = list(df = 5),color="red")+
  annotate("text", x = rep(1.7,4), y = seq(.39,.31,length.out = 4), 
           label = paste0("GL = ",c(70,35,10,5)) , size=4 , 
           color=c("blue","green","orange","red"))+
  theme_bw()
```
Al cambiar la forma de la curva, el valor de los cuantiles cambia tambien, como se puede apreciar en la siguiente tabla 
```{r echo=FALSE, results = 'asis'}
t1<-kable(data.frame(GL=c(70,35,10,5),t_0.05=qt(.05,c(70,35,10,5))))
kable_styling(t1,"striped", position = "left")

```
## Intervalo de confianza para la varianza
La formula del intervalo de confianza para la varianza tiene la siguiente formula:

$$\Bigg( S-t_{n-1,1-\frac{\alpha}{2}}\times\frac{S}{\sqrt{n}},\bar{X}-t_{n-1,\frac{\alpha}{2}}\times\frac{S}{\sqrt{n}}\Bigg)$$

#Ejercicio 1
  
El peso de 71 gallinas fue medido en kilogramos. Calcule el intervalo de confianza al 95% para el valor esperado de esta muestra en base a la siguiente informaci칩n:

* $\bar{X}=$ `r round(mean(chickwts$weight),3)`
* $S=$ `r round(sd(chickwts$weight),3)`
* $n=$ `r nrow(chickwts)`
* $\alpha= 0.05$ ya que la confianza es del 95% 

Escoja los cuantiles adecuados para calcular el intervalo de confianza:
```{r echo=FALSE, results = 'asis'}
my_df<-c(5,10,35,70,100)  
t2<-data.frame(GL=my_df,q0.025=qt(0.025,my_df),q0.05=qt(0.05,my_df),q0.1=qt(0.1,my_df),q0.9=qt(0.9,my_df),q0.95=qt(0.95,my_df),q0.975=qt(0.975,my_df))

t2<-kable(t2)
kable_styling(t2,"striped", position = "left")

```
Ahora calcule el intervalo con un nivel de confianza del 90%

#Ejercicio 2


